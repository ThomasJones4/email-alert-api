#!/usr/bin/env ruby
require_relative '../config/application'
Rails.application.require_environment!

if ARGV.include?("--help")
  puts "  Usage: ./bin/report --after 2017-01-01 --before 2017-01-31"
  exit
end

options = ARGV.each_slice(2).to_h

options["--before"] ||= Time.now.to_s
options["--after"] ||= "2017-06-01"

before = Time.parse(options.fetch("--before"))
after = Time.parse(options.fetch("--after"))

scope = NotificationLog.where(created_at: after..before)

NotificationReport.new(scope).print
